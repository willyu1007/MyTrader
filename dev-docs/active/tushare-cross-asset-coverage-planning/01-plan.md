# 01 Plan

## Phase 1: 口径与权限基线
1. 按资产类型完成 L1/L2 子类确认（股票、ETF、指数、期货、现货、外汇、宏观）。
2. 明确双池职责边界与状态语义（`complete/partial/missing/not_applicable`）。
3. 对关键接口做真实 token 可用性探测，沉淀权限基线。
4. 验收标准：
- 每类资产均有“纳入项/排除项/原因”。
- 高门槛接口可用性有实测结论。

## Phase 2: 统一模型与映射设计
1. 完成“模块 -> Tushare 接口”映射与优先级分层。
2. 完成“模块 -> SSOT 表 -> Target 消费”映射。
3. 完成跨资产关联层设计：
- 统一主档、统一日历、统一关系表（指数/行业/概念成分）、统一事件表、统一宏观长表。
4. 验收标准：
- 每个 L1 模块可追溯到接口、存储和消费路径。
- `SSOT-first` 主路径清晰，降级路径可控。

## Phase 3: 批次落地规划
1. P0（高优）：股票、ETF、指数、期货、现货。
2. P1（扩展）：外汇、宏观。
3. P2（增强）：权限型/专题型接口（分钟/实时与扩展专题）与衍生特征。
4. 验收标准：
- 每个批次有最小可交付清单与回滚开关。
- 每批次定义覆盖率与质量门禁阈值。
5. 执行清单：
- P0：先一次建齐统一表（`instrument_master/basket_membership_daily/corporate_events`），再打通 Universe 入库、Target 状态与调度回归。
- P1：先落外汇，再落宏观模块，最后做 `available_date` 回测安全校验。
- P2：先做权限探测，再按模块灰度放开，保持核心链路不回退。

## Phase 4: 验收与运行门禁
1. 覆盖率验收：按资产抽样验证模块状态与矩阵一致。
2. 统计验收：`inserted/updated/errors` 可对账且口径一致。
3. 调度验收：手动、定时、启动补跑、暂停/恢复/取消可用。
4. 回测安全验收：宏观与低频数据遵循 `available_date`，无未来数据穿越。
5. 阈值口径：
- P0 必选核心模块 `complete+partial >= 95%`。
- P1 外汇与宏观模块 `missing` 比例 <= 5%（20 个交易日窗口）。
- 所有批次关键字段空值率 <= 0.5%，主键冲突 = 0。

## 当前阶段结论（2026-02-19）
1. Phase 1、Phase 2 已完成规划层对齐并有实测支撑。
2. `stk_premarket` 当前 token 无权限，且已确认不进入当前规划范围。
3. Phase 3/4 的批次执行、门禁阈值与 `available_date` 滞后规则已定稿，下一步可进入实施阶段。
